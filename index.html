<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Wagyu Paitan | Side Hustle(Dark)</title>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;600;700&family=Inter:wght@300;400;500;600&display=swap" rel="stylesheet">

    <!-- Palette and Custom Styles -->
    <style>
        :root {
            /* Dark Theme Palette */
            --color-bg: #121212;
            --color-surface: #1E1E1E;
            --color-surface-hover: #2C2C2C;
            --color-text-main: #E0E0E0;
            --color-text-muted: #A0A0A0;
            --color-gold: #D4AF37; /* Slightly brighter gold for dark mode */
            --color-jus: #8D6E63; /* Lighter brown for visibility */
            --color-danger: #EF5350;
            --color-border: #333333;
            --color-input-bg: #2C2C2C;
        }

        body {
            font-family: 'Inter', sans-serif;
            background-color: var(--color-bg);
            color: var(--color-text-main);
        }

        h1, h2, h3, h4, .serif {
            font-family: 'Playfair Display', serif;
        }

        /* Chart Container Rules */
        .chart-container {
            position: relative;
            width: 100%;
            max-width: 600px;
            margin-left: auto;
            margin-right: auto;
            height: 300px;
            max-height: 400px;
        }
        
        @media (min-width: 768px) {
            .chart-container {
                height: 350px;
            }
        }

        /* Custom Scrollbar (Dark Mode) */
        .custom-scrollbar::-webkit-scrollbar { width: 6px; height: 6px; }
        .custom-scrollbar::-webkit-scrollbar-track { background: #1E1E1E; }
        .custom-scrollbar::-webkit-scrollbar-thumb { background: #555; border-radius: 4px; }
        .custom-scrollbar::-webkit-scrollbar-thumb:hover { background: #777; }

        /* Timeline Connector Lines */
        .timeline-line {
            position: absolute;
            left: 1.25rem;
            top: 2.5rem;
            bottom: -1rem;
            width: 2px;
            background-color: var(--color-border);
            z-index: 0;
        }
        .timeline-item:last-child .timeline-line { display: none; }
        
        /* Active State Styles - Dynamic based on mode */
        .nav-btn.active {
            border-bottom-width: 2px;
            font-weight: 600;
        }
        
        .step-active {
            border-left-width: 4px;
            background-color: #2A2A20; /* Darker Gold tint background */
        }

        /* Mode specific classes applied via JS */
        .mode-gold .nav-btn.active { border-color: var(--color-gold); color: var(--color-gold); }
        .mode-gold .step-active { border-left-color: var(--color-gold); }
        .mode-gold .recipe-input:focus { outline-color: var(--color-gold); }
        
        .mode-jus .nav-btn.active { border-color: var(--color-jus); color: var(--color-jus); }
        .mode-jus .step-active { border-left-color: var(--color-jus); background-color: #2A2624; /* Darker Brown tint */ }
        .mode-jus .recipe-input:focus { outline-color: var(--color-jus); }

        .fade-in { animation: fadeIn 0.5s ease-out; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }

        /* Modal Transitions */
        .modal { transition: opacity 0.25s ease; }
        .modal-active { overflow-x: hidden; overflow-y: visible !important; }
        
        .recipe-input {
            background-color: var(--color-input-bg);
            color: var(--color-text-main);
            border: 1px solid var(--color-border);
        }
        .recipe-input:focus { border-color: transparent; outline-style: solid; outline-width: 2px; }

        /* Tables */
        thead { background-color: #2C2C2C; }
        tr.hover\:bg-gray-50:hover { background-color: var(--color-surface-hover) !important; }
        td, th { border-color: var(--color-border); }

    </style>
</head>
<body class="antialiased min-h-screen flex flex-col mode-gold transition-colors duration-300">

    <!-- Header -->
    <header class="bg-[#1E1E1E] border-b border-[#333333] sticky top-0 z-50 shadow-lg">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between items-center h-16">
                <div class="flex items-center gap-3">
                    <div id="logo-bg" class="h-8 w-8 bg-[#D4AF37] text-[#121212] flex items-center justify-center rounded font-serif font-bold text-xl transition-colors duration-300">W</div>
                    <div>
                        <h1 class="text-xl font-bold serif text-[#E0E0E0] leading-none">Wagyu Paitan</h1>
                        <p class="text-xs text-[#A0A0A0] font-medium tracking-wide">Side Hustle</p>
                    </div>
                </div>
                <!-- Desktop Nav -->
                <nav class="hidden md:flex space-x-8">
                    <button onclick="switchTab('dashboard')" class="nav-btn active py-5 text-sm font-medium text-[#A0A0A0] hover:text-[#E0E0E0] transition-colors">Overview</button>
                    <button onclick="switchTab('components')" class="nav-btn py-5 text-sm font-medium text-[#A0A0A0] hover:text-[#E0E0E0] transition-colors">Components</button>
                    <button onclick="switchTab('inventory')" class="nav-btn py-5 text-sm font-medium text-[#A0A0A0] hover:text-[#E0E0E0] transition-colors">Inventory</button>
                    <button onclick="switchTab('process')" class="nav-btn py-5 text-sm font-medium text-[#A0A0A0] hover:text-[#E0E0E0] transition-colors">Procedure</button>
                    <button onclick="switchTab('assembly')" class="nav-btn py-5 text-sm font-medium text-[#A0A0A0] hover:text-[#E0E0E0] transition-colors">Assembly</button>
                </nav>
                <button onclick="toggleMobileMenu()" class="md:hidden text-[#E0E0E0] focus:outline-none"><span class="text-2xl">‚ò∞</span></button>
            </div>
        </div>
        <!-- Mobile Nav Panel -->
        <div id="mobile-menu" class="hidden md:hidden bg-[#1E1E1E] border-t border-[#333333] px-4 py-2 space-y-2">
            <button onclick="switchTab('dashboard')" class="block w-full text-left py-2 font-medium text-[#A0A0A0]">Overview</button>
            <button onclick="switchTab('components')" class="block w-full text-left py-2 font-medium text-[#A0A0A0]">Components</button>
            <button onclick="switchTab('inventory')" class="block w-full text-left py-2 font-medium text-[#A0A0A0]">Inventory</button>
            <button onclick="switchTab('process')" class="block w-full text-left py-2 font-medium text-[#A0A0A0]">Procedure</button>
            <button onclick="switchTab('assembly')" class="block w-full text-left py-2 font-medium text-[#A0A0A0]">Assembly</button>
        </div>
    </header>

    <!-- Main Content -->
    <main class="flex-grow max-w-7xl mx-auto w-full px-4 sm:px-6 lg:px-8 py-8">

        <!-- DASHBOARD -->
        <section id="dashboard" class="fade-in space-y-8">
            <div class="flex flex-col md:flex-row justify-between items-start md:items-center mb-8">
                <div class="text-center md:text-left">
                    <h2 class="text-3xl font-bold serif text-[#E0E0E0] mb-2">Operational Dashboard</h2>
                    <p class="text-[#A0A0A0] max-w-3xl">
                        Standard 20-bowl batch protocol. Current Mode: <span id="dashboardModeLabel" class="font-bold text-[#D4AF37]">Wagyu Gold</span>
                    </p>
                </div>
                <!-- Global Mode Toggle -->
                <div class="mt-4 md:mt-0 bg-[#1E1E1E] border border-[#333333] p-1 rounded-lg flex items-center shadow-sm">
                    <button id="dashModeGold" onclick="setGlobalMode('gold')" class="px-6 py-2 rounded text-sm font-bold transition-colors bg-[#D4AF37] text-[#121212]">Wagyu Gold</button>
                    <button id="dashModeJus" onclick="setGlobalMode('jus')" class="px-6 py-2 rounded text-sm font-bold transition-colors text-[#A0A0A0] hover:bg-[#2C2C2C]">Beef Jus</button>
                </div>
            </div>

            <!-- KPI Cards -->
            <div class="grid grid-cols-1 md:grid-cols-4 gap-4">
                <div class="bg-[#1E1E1E] p-6 rounded-lg shadow-md border border-[#333333]">
                    <div id="kpi-yield-label" class="text-xs font-semibold tracking-wider text-[#D4AF37] mb-1">BASE YIELD</div>
                    <div class="text-3xl font-bold serif text-[#E0E0E0]">7.0 <span class="text-lg font-sans text-[#A0A0A0] font-normal">Liters</span></div>
                    <div class="text-xs text-[#A0A0A0] mt-2">After reduction</div>
                </div>
                <div class="bg-[#1E1E1E] p-6 rounded-lg shadow-md border border-[#333333]">
                    <div id="kpi-collagen-label" class="text-xs font-semibold tracking-wider text-[#D4AF37] mb-1">COLLAGEN SOURCE</div>
                    <div class="text-3xl font-bold serif text-[#E0E0E0]">Tendon <span class="text-lg font-sans text-[#A0A0A0] font-normal">Blitz</span></div>
                    <div class="text-xs text-[#A0A0A0] mt-2">Immersion Blended</div>
                </div>
                <div class="bg-[#1E1E1E] p-6 rounded-lg shadow-md border border-[#333333]">
                    <div id="kpi-protein-label" class="text-xs font-semibold tracking-wider text-[#D4AF37] mb-1">PROTEIN</div>
                    <div class="text-3xl font-bold serif text-[#E0E0E0]">Sous Vide <span class="text-lg font-sans text-[#A0A0A0] font-normal">Chuck</span></div>
                    <div class="text-xs text-[#A0A0A0] mt-2">57¬∞C / 24 Hours</div>
                </div>
                <div class="bg-[#1E1E1E] p-6 rounded-lg shadow-md border border-[#333333]">
                    <div id="kpi-cost-label" class="text-xs font-semibold tracking-wider text-[#D4AF37] mb-1">EST. COST / BOWL</div>
                    <div class="text-3xl font-bold serif text-[#E0E0E0]">$<span id="costPerBowl">--</span> <span class="text-lg font-sans text-[#A0A0A0] font-normal">CAD</span></div>
                    <div class="text-xs text-[#A0A0A0] mt-2">Calculated Live</div>
                </div>
            </div>

            <!-- Flavor Radar -->
            <div class="bg-[#1E1E1E] p-6 rounded-lg shadow-md border border-[#333333] mt-8">
                <div class="flex justify-between items-center mb-6">
                    <h3 class="text-lg font-bold serif flex items-center gap-2 text-[#E0E0E0]"><span>üéØ</span> Flavor Profile Analysis</h3>
                </div>
                <div class="chart-container">
                    <canvas id="flavorRadar"></canvas>
                </div>
            </div>
        </section>

        <!-- COMPONENTS (RECIPES) -->
        <section id="components" class="hidden fade-in space-y-8">
            <div class="text-center md:text-left mb-6">
                <h2 class="text-3xl font-bold serif text-[#E0E0E0] mb-2">Master Recipe Selector</h2>
                <p class="text-[#A0A0A0] max-w-xl">
                    Configure your batch sizes for the selected Tare profile.
                </p>
            </div>

            <div class="bg-[#1E1E1E] rounded-lg shadow-md border border-[#333333] overflow-hidden">
                <div id="recipeHeader" class="bg-[#D4AF37] p-4 text-[#121212] flex justify-between items-center flex-wrap gap-2 transition-colors duration-300">
                    <h3 id="recipeTitle" class="text-xl font-bold serif">Wagyu Gold Tare</h3>
                    <div class="flex items-center gap-2">
                        <span id="recipeInputLabel" class="text-xs uppercase tracking-wide font-bold opacity-80">Yield (ml):</span>
                        <input type="number" id="recipeTarget" value="1000" oninput="calculateRecipe()" class="recipe-input w-24 px-2 py-1 rounded text-[#E0E0E0] font-mono text-sm font-bold bg-[#1E1E1E] border-none">
                    </div>
                </div>
                <div class="grid grid-cols-1 lg:grid-cols-3">
                    <div class="p-6 border-b lg:border-b-0 lg:border-r border-[#333333]">
                        <h4 class="font-bold text-[#A0A0A0] uppercase tracking-wide text-xs mb-4">Ingredients Matrix</h4>
                        <ul id="recipeList" class="space-y-3 text-sm"></ul>
                        <div class="mt-6 pt-6 border-t border-[#333333]">
                            <div class="chart-container" style="height: 180px;"><canvas id="recipeChart"></canvas></div>
                        </div>
                    </div>
                    <div class="col-span-2 p-6 bg-[#252525]">
                        <h4 class="font-bold text-[#E0E0E0] uppercase tracking-wide text-xs mb-4">Production Methodology</h4>
                        <div id="recipeMethod" class="prose text-sm text-[#A0A0A0]"></div>
                    </div>
                </div>
            </div>
        </section>

        <!-- INVENTORY -->
        <section id="inventory" class="hidden fade-in space-y-8">
            <div class="flex flex-col md:flex-row justify-between items-start md:items-end">
                <div>
                    <h2 class="text-3xl font-bold serif text-[#E0E0E0] mb-2">Inventory Requirements</h2>
                    <p class="text-[#A0A0A0] max-w-3xl">Current List for: <span id="inventoryLabel" class="font-bold text-[#D4AF37]">Wagyu Gold</span></p>
                </div>
            </div>
            <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
                <div class="lg:col-span-2 bg-[#1E1E1E] rounded-lg shadow-md border border-[#333333] overflow-hidden flex flex-col">
                    <div class="p-4 border-b border-[#333333] bg-[#2C2C2C] flex justify-between items-center flex-wrap gap-2">
                        <h3 class="font-bold serif text-[#E0E0E0]">Batch Ingredient List</h3>
                        <div class="flex gap-2">
                            <button onclick="filterInventory('all')" class="text-xs px-3 py-1 bg-[#1E1E1E] border border-[#333333] rounded text-[#A0A0A0] hover:bg-[#333333] transition">All</button>
                            <button onclick="filterInventory('Bones')" class="text-xs px-3 py-1 bg-[#1E1E1E] border border-[#333333] rounded text-[#A0A0A0] hover:bg-[#333333] transition">Bones</button>
                            <button onclick="filterInventory('Seasoning')" class="text-xs px-3 py-1 bg-[#1E1E1E] border border-[#333333] rounded text-[#A0A0A0] hover:bg-[#333333] transition">Seasoning</button>
                        </div>
                    </div>
                    <div class="overflow-x-auto custom-scrollbar flex-grow">
                        <table class="w-full text-sm text-left text-[#A0A0A0]">
                            <thead class="bg-[#2C2C2C] text-[#E0E0E0] font-medium border-b border-[#333333]">
                                <tr>
                                    <th class="px-6 py-3">Ingredient</th>
                                    <th class="px-6 py-3">Specification</th>
                                    <th class="px-6 py-3 text-right">Qty</th>
                                    <th class="px-6 py-3 text-right">Cost</th>
                                    <th class="px-6 py-3 text-center">Edit</th>
                                </tr>
                            </thead>
                            <tbody id="inventoryTableBody" class="divide-y divide-[#333333]"></tbody>
                        </table>
                    </div>
                </div>
                <div class="space-y-6">
                    <div class="bg-[#1E1E1E] p-6 rounded-lg shadow-md border border-[#333333]">
                        <h3 id="cost-chart-label" class="text-sm font-bold uppercase tracking-wider text-[#D4AF37] mb-2">Cost Drivers</h3>
                        <div class="chart-container" style="height: 250px;"><canvas id="costChart"></canvas></div>
                    </div>
                </div>
            </div>
        </section>

        <!-- PROCESS -->
        <section id="process" class="hidden fade-in space-y-8">
            <div class="text-center md:text-left">
                <h2 class="text-3xl font-bold serif text-[#E0E0E0] mb-2">Production Procedure</h2>
                <p class="text-[#A0A0A0] max-w-3xl">Active Workflow: <span id="processLabel" class="font-bold text-[#D4AF37]">Wagyu Gold</span></p>
            </div>
            <div class="grid grid-cols-1 lg:grid-cols-12 gap-8">
                <div class="lg:col-span-4 space-y-0" id="timelineNav"></div>
                <div class="lg:col-span-8">
                    <div id="stepDetailPanel" class="bg-[#1E1E1E] p-8 rounded-lg shadow-md border border-[#333333] sticky top-24 min-h-[500px]">
                        <div class="flex items-center gap-3 mb-6">
                            <span id="detailIcon" class="text-4xl">‚è±Ô∏è</span>
                            <div>
                                <h3 id="detailTitle" class="text-2xl font-bold serif text-[#E0E0E0]">Select a Step</h3>
                                <p id="detailDuration" class="text-sm font-bold text-[#D4AF37] uppercase tracking-wide"></p>
                            </div>
                        </div>
                        <div class="prose prose-invert max-w-none">
                            <p id="detailDesc" class="text-lg text-[#A0A0A0] mb-6"></p>
                            <div id="detailChecklistContainer" class="hidden">
                                <h4 class="font-bold text-[#E0E0E0] mb-3 border-b border-[#333333] pb-2">Critical Actions</h4>
                                <ul id="detailChecklist" class="space-y-3 mb-8 text-[#A0A0A0]"></ul>
                                <div class="bg-[#252525] p-4 rounded border border-[#333333]" id="tipContainer">
                                    <h4 class="font-bold text-[#D4AF37] text-sm mb-1">‚ö†Ô∏è Pro Tip</h4>
                                    <p id="detailTip" class="text-sm text-[#E0E0E0] italic"></p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- ASSEMBLY -->
        <section id="assembly" class="hidden fade-in space-y-8">
            <div class="text-center md:text-left">
                <h2 class="text-3xl font-bold serif text-[#E0E0E0] mb-2">Service & Assembly</h2>
                <p class="text-[#A0A0A0] max-w-3xl">Standard build: 350ml Soup, 35ml Tare (10%), 15ml Oil.</p>
            </div>
            <div class="bg-[#1E1E1E] rounded-lg shadow-md border border-[#333333] p-8">
                <div class="grid grid-cols-1 md:grid-cols-2 gap-12 items-center">
                    <div class="relative w-full max-w-sm mx-auto h-80 flex flex-col justify-end items-center">
                        <div class="absolute inset-0 flex items-center justify-center -z-10 opacity-10 text-[#333333]"><span class="text-9xl">üçú</span></div>
                        <div class="w-48 w-full max-w-[200px] flex flex-col-reverse border-2 border-[#333333] border-t-0 rounded-b-full overflow-hidden bg-[#2C2C2C] relative h-64 shadow-inner">
                            <div class="w-full bg-[#E8C547] h-[15%] flex items-center justify-center text-[10px] text-black font-bold opacity-80">Wagyu Chuck</div>
                            <div class="w-full bg-[#F2E8CF] h-[25%] flex items-center justify-center text-xs text-black font-bold border-t border-black/10">Sun Noodle</div>
                            <div class="w-full bg-[#E0E0E0] h-[50%] flex items-center justify-center text-xs text-black font-bold border-t border-black/10 transition-all duration-500">Wagyu Paitan</div>
                            <div class="w-full bg-[#D4AF37] h-[10%] flex items-center justify-center text-[10px] text-black font-bold border-t border-black/10 transition-all duration-500">Tare/Oil</div>
                        </div>
                    </div>
                    <div class="space-y-6">
                        <div class="border-b border-[#333333] pb-4"><h3 class="text-xl font-bold serif text-[#E0E0E0]">Specs</h3><p class="text-sm text-[#A0A0A0]">Service temp must be >85¬∞C.</p></div>
                        <div class="space-y-4">
                            <div class="flex justify-between items-center p-3 bg-[#2C2C2C] rounded"><span class="font-bold text-[#E0E0E0]">Bowl Prep</span><span class="text-[#D4AF37] font-mono">Pre-heat Ceramic</span></div>
                            <div class="flex justify-between items-center p-3 bg-[#2C2C2C] rounded"><span class="font-bold text-[#E0E0E0]">Noodle</span><span class="text-[#D4AF37] font-mono">1m 45s (Sun Noodle)</span></div>
                        </div>
                    </div>
                </div>
            </div>
        </section>

    </main>

    <!-- Footer -->
    <footer class="bg-[#1E1E1E] border-t border-[#333333] mt-auto py-8">
        <div class="max-w-7xl mx-auto px-4 text-center"><p class="text-xs text-[#585858]">Wagyu Paitan Side Hustle &copy; 2024.</p></div>
    </footer>

    <!-- MODAL -->
    <div id="editModal" class="modal opacity-0 pointer-events-none fixed w-full h-full top-0 left-0 flex items-center justify-center z-50">
        <div class="modal-overlay absolute w-full h-full bg-black opacity-75" onclick="closeEditModal()"></div>
        <div class="modal-container bg-[#1E1E1E] w-11/12 md:max-w-md mx-auto rounded shadow-lg z-50 overflow-y-auto transform transition-all scale-95 duration-200 border border-[#333333]">
            <div class="modal-content py-4 text-left px-6">
                <div class="flex justify-between items-center pb-3 border-b border-[#333333]"><p class="text-2xl font-bold text-[#E0E0E0] serif">Edit Ingredient</p><div class="cursor-pointer z-50" onclick="closeEditModal()"><span class="text-2xl text-[#A0A0A0] hover:text-[#E0E0E0]">&times;</span></div></div>
                <div class="py-4 space-y-4">
                    <input type="hidden" id="editItemId">
                    <div><label class="block text-sm font-bold text-[#A0A0A0] mb-1">Item Name</label><input type="text" id="editItemName" class="recipe-input w-full p-2 rounded"></div>
                    <div><label class="block text-sm font-bold text-[#A0A0A0] mb-1">Brand / Spec</label><input type="text" id="editItemBrand" class="recipe-input w-full p-2 rounded"></div>
                    <div class="flex gap-4"><div class="w-1/2"><label class="block text-sm font-bold text-[#A0A0A0] mb-1">Qty</label><input type="number" step="0.01" id="editItemQty" class="recipe-input w-full p-2 rounded"></div><div class="w-1/2"><label class="block text-sm font-bold text-[#A0A0A0] mb-1">Unit</label><input type="text" id="editItemUnit" class="recipe-input w-full p-2 rounded bg-[#2C2C2C]" readonly></div></div>
                    <div><label class="block text-sm font-bold text-[#A0A0A0] mb-1">Cost ($)</label><input type="number" step="0.01" id="editItemCost" class="recipe-input w-full p-2 rounded"></div>
                </div>
                <div class="flex justify-end pt-2"><button onclick="closeEditModal()" class="px-4 py-2 text-[#A0A0A0] hover:text-[#E0E0E0] mr-2">Cancel</button><button onclick="saveEdit()" class="px-4 py-2 bg-[#D4AF37] text-[#121212] font-bold rounded hover:bg-[#F9A825]" id="modalSaveBtn">Save</button></div>
            </div>
        </div>
    </div>
    <div id="toast" class="fixed bottom-4 right-4 bg-[#E0E0E0] text-[#121212] px-6 py-3 rounded shadow-lg transform translate-y-20 transition-transform duration-300 flex items-center gap-2 z-50"><span id="toastIcon" class="text-[#D4AF37]">‚úì</span><span id="toastMsg">Saved</span></div>

    <!-- LOGIC -->
    <script>
        // --- CONFIGURATION FOR DARK MODE CHARTS ---
        Chart.defaults.color = '#A0A0A0';
        Chart.defaults.borderColor = '#333333';

        // --- DATA STORE ---
        // Inventory Base (Shared items)
        const baseInventory = [
            { id: 1, item: "Wagyu Marrow Bones", category: "Bones", brand: "Brant Lake Wagyu", qty: 5.5, unit: "kg", cost: 48.00 },
            { id: 2, item: "Beef Tendons (Green)", category: "Bones", brand: "Glenwood Meats", qty: 1.8, unit: "kg", cost: 15.00 },
            { id: 3, item: "Beef Neck Bones", category: "Bones", brand: "Brant Lake Wagyu", qty: 1.8, unit: "kg", cost: 18.00 },
            { id: 10, item: "Sun Noodle (Hakata)", category: "Topping", brand: "Wismettac", qty: 22, unit: "portions", cost: 26.40 },
            { id: 11, item: "Beef Chuck (Sous Vide)", category: "Topping", brand: "Alberta AAA", qty: 1.4, unit: "kg", cost: 25.00 },
            { id: 12, item: "Ajitama (Eggs)", category: "Topping", brand: "Local Free Run", qty: 20, unit: "pcs", cost: 10.00 },
            { id: 13, item: "A5 Fat Trimming", category: "Bones", brand: "Brant Lake", qty: 0.5, unit: "kg", cost: 2.00 },
            { id: 14, item: "Ginger Root", category: "Aromatics", brand: "Fresh Root (Strict)", qty: 100, unit: "g", cost: 1.50 },
        ];

        // Specific Tare Ingredients
        const goldIngredients = [
            { id: 200, item: "Shiro Shoyu (White)", category: "Seasoning", brand: "True World Foods", qty: 150, unit: "ml", cost: 8.00 },
            { id: 201, item: "Hon Mirin", category: "Seasoning", brand: "True World Foods", qty: 500, unit: "ml", cost: 6.00 },
            { id: 202, item: "Sake", category: "Seasoning", brand: "Hakutsuru", qty: 250, unit: "ml", cost: 5.00 },
            { id: 203, item: "Fine Sea Salt", category: "Seasoning", brand: "Generic", qty: 150, unit: "g", cost: 1.00 },
            { id: 204, item: "Dried Shiitake", category: "Seasoning", brand: "True World Foods", qty: 5, unit: "pcs", cost: 2.00 },
        ];

        const jusIngredients = [
            { id: 300, item: "Koikuchi Shoyu (Aged)", category: "Seasoning", brand: "Takesan Kishibori", qty: 300, unit: "ml", cost: 12.00 },
            { id: 301, item: "Smoked Shoyu", category: "Seasoning", brand: "Suehiro Premium", qty: 50, unit: "ml", cost: 8.00 },
            { id: 302, item: "Usukuchi Shoyu", category: "Seasoning", brand: "Higashimaru", qty: 100, unit: "ml", cost: 4.00 },
            { id: 303, item: "Hon Mirin", category: "Seasoning", brand: "Takara", qty: 150, unit: "ml", cost: 3.00 },
            { id: 304, item: "Cooking Sake", category: "Seasoning", brand: "Takara Sho Chiku Bai", qty: 150, unit: "ml", cost: 3.00 },
            { id: 305, item: "Hidaka Kombu", category: "Seasoning", brand: "Okui Kaisendo", qty: 50, unit: "g", cost: 5.00 },
            { id: 306, item: "Niboshi", category: "Seasoning", brand: "Marutomo", qty: 30, unit: "g", cost: 3.00 },
        ];

        let inventoryData = [...baseInventory, ...goldIngredients]; // Default

        // RECIPES
        const tareGold = [
            { name: "Hon Mirin", pct: 0.40, unit: "ml" },
            { name: "Sake", pct: 0.20, unit: "ml" },
            { name: "Shiro Shoyu", pct: 0.10, unit: "ml" },
            { name: "Fine Sea Salt", pct: 0.10, unit: "g" },
            { name: "Dried Shiitake", pct: 0.20, unit: "pcs" }
        ];

        const tareJus = [
            { name: "Soup Base (Reduced)", pct: 0.40, unit: "ml" }, 
            { name: "Koikuchi Shoyu", pct: 0.35, unit: "ml" },
            { name: "Mirin", pct: 0.10, unit: "ml" },
            { name: "Sake", pct: 0.10, unit: "ml" },
            { name: "Smoked Shoyu", pct: 0.05, unit: "ml" }
        ];

        // METHODOLOGIES
        const methodGold = `
            <ol class="list-decimal list-inside space-y-2">
                <li><strong>Alcohol Burn:</strong> Combine Sake and Mirin in a saucepot. Boil for 2-3 minutes to evaporate alcohol.</li>
                <li><strong>Dissolution:</strong> Add Fine Sea Salt and stir until completely dissolved.</li>
                <li><strong>Infusion:</strong> Remove from heat. Add Shiro Shoyu and Dried Shiitake. Let cool to room temp. <span class="text-[#D4AF37] font-bold">DO NOT BOIL SHOYU.</span></li>
                <li><strong>Result:</strong> A clear, golden liquid that preserves the soup's whiteness.</li>
            </ol>
        `;

        const methodJus = `
            <ol class="list-decimal list-inside space-y-2">
                <li><strong>Reduction (Critical):</strong> Take 500ml of your main Gyukotsu broth. Add Sake and Mirin. Boil firmly to reduce volume by 50% (approx 350ml). This creates a gelatinous demi-glace texture.</li>
                <li><strong>Infusion:</strong> Lower heat to 80¬∞C. Add Kombu/Niboshi. Steep 30 mins.</li>
                <li><strong>Marriage:</strong> Stir in Takesan Koikuchi, Usukuchi, and Smoked Shoyu. Heat to 80¬∞C to sanitize, then kill heat immediately.</li>
                <li><strong>Result:</strong> A dark, viscous, smoky sauce that tastes like roast beef drippings.</li>
            </ol>
        `;

        // PROCESS STEPS
        const commonSteps = [
            { id: 1, title: "The Purge (24hr)", duration: "24 Hours", icon: "ü©∏", desc: "Non-negotiable for Wagyu bones. Remove blood to prevent grey soup.", checklist: ["Submerge Brant Lake bones in cold water.", "Change water every 6 hrs.", "Store in walk-in cooler."], tip: "Water must run clear before boiling.", warning: null },
            { id: 2, title: "Extraction", duration: "12 Hours", icon: "üî•", desc: "Violent boil to extract fat and flavor.", checklist: ["Boil bones violently for 12 hours.", "Maintain water level.", "Remove large bones."], tip: "Keep the lid cracked.", warning: null },
            { id: 3, title: "Aromatics", duration: "Last 2 Hours", icon: "üßÖ", desc: "Add vegetables late.", checklist: ["Add Charred Onions.", "Add FRESH Ginger slices.", "Add Garlic."], tip: "Remove before vegetables disintegrate.", warning: "DO NOT USE GINGER POWDER." },
            { id: 4, title: "The Tendon Blitz", duration: "30 Mins", icon: "üå™Ô∏è", desc: "Force-emulsifying the cooked tendons.", checklist: ["Ensure tendons are soft.", "Use commercial immersion blender.", "Blend tendons directly into liquid.", "Result: Beige Latte texture."], tip: "Don't skip this.", warning: null },
        ];

        let activeMode = 'gold';

        // --- APP LOGIC ---
        let currentTab = 'dashboard';
        let charts = {};
        let currentFilter = 'all';

        function switchTab(tabId) {
            document.querySelectorAll('main > section').forEach(el => el.classList.add('hidden'));
            document.getElementById(tabId).classList.remove('hidden');
            document.querySelectorAll('.nav-btn').forEach(btn => btn.classList.toggle('active', btn.getAttribute('onclick').includes(tabId)));
            document.getElementById('mobile-menu').classList.add('hidden');
            
            if (tabId === 'dashboard' && !charts.radar) renderDashboardCharts();
            if (tabId === 'inventory') { 
                updateInventoryData(); 
                renderInventoryTable(currentFilter); 
                renderInventoryCharts(); 
            }
            if (tabId === 'process') renderTimeline();
            if (tabId === 'components') calculateRecipe();
            currentTab = tabId;
        }

        function toggleMobileMenu() { document.getElementById('mobile-menu').classList.toggle('hidden'); }

        function setGlobalMode(mode) {
            activeMode = mode;
            const body = document.body;
            const logo = document.getElementById('logo-bg');
            
            // Toggle Logic for UI
            if (mode === 'gold') {
                body.classList.remove('mode-jus');
                body.classList.add('mode-gold');
                logo.classList.replace('bg-[#2D2A26]', 'bg-[#D4AF37]');
                logo.classList.replace('text-[#E0E0E0]', 'text-[#121212]');
                
                // Dashboard Buttons
                document.getElementById('dashModeGold').classList.replace('text-[#A0A0A0]', 'text-[#121212]');
                document.getElementById('dashModeGold').classList.replace('hover:bg-[#2C2C2C]', 'bg-[#D4AF37]');
                document.getElementById('dashModeGold').classList.remove('bg-[#1E1E1E]');
                document.getElementById('dashModeJus').classList.replace('text-[#121212]', 'text-[#A0A0A0]');
                document.getElementById('dashModeJus').classList.replace('bg-[#8D6E63]', 'hover:bg-[#2C2C2C]');
                document.getElementById('dashModeJus').classList.add('bg-[#1E1E1E]');

                // Labels
                document.getElementById('dashboardModeLabel').innerText = "Wagyu Gold";
                document.getElementById('dashboardModeLabel').className = "font-bold text-[#D4AF37]";
                document.getElementById('recipeTitle').innerText = "Wagyu Gold Tare";
                document.getElementById('recipeInputLabel').innerText = "Yield (ml):"; // Reset label
                document.getElementById('recipeMethod').innerHTML = methodGold;
                document.getElementById('recipeHeader').classList.replace('bg-[#8D6E63]', 'bg-[#D4AF37]');
                
                document.getElementById('inventoryLabel').innerText = "Wagyu Gold";
                document.getElementById('inventoryLabel').className = "font-bold text-[#D4AF37]";
                document.getElementById('processLabel').innerText = "Wagyu Gold";
                document.getElementById('processLabel').className = "font-bold text-[#D4AF37]";
                
                // Color updates
                updateColors('#D4AF37');

            } else {
                body.classList.remove('mode-gold');
                body.classList.add('mode-jus');
                logo.classList.replace('bg-[#D4AF37]', 'bg-[#8D6E63]');
                logo.classList.replace('text-[#121212]', 'text-[#E0E0E0]');

                // Dashboard Buttons
                document.getElementById('dashModeJus').classList.replace('text-[#A0A0A0]', 'text-[#E0E0E0]');
                document.getElementById('dashModeJus').classList.replace('hover:bg-[#2C2C2C]', 'bg-[#8D6E63]');
                document.getElementById('dashModeJus').classList.remove('bg-[#1E1E1E]');
                document.getElementById('dashModeGold').classList.replace('text-[#121212]', 'text-[#A0A0A0]');
                document.getElementById('dashModeGold').classList.replace('bg-[#D4AF37]', 'hover:bg-[#2C2C2C]');
                document.getElementById('dashModeGold').classList.add('bg-[#1E1E1E]');

                // Labels
                document.getElementById('dashboardModeLabel').innerText = "Beef Jus";
                document.getElementById('dashboardModeLabel').className = "font-bold text-[#8D6E63]";
                document.getElementById('recipeTitle').innerText = "Beef Jus Tare";
                document.getElementById('recipeInputLabel').innerText = "Base Broth (ml):"; // Change label for Jus logic
                document.getElementById('recipeMethod').innerHTML = methodJus;
                document.getElementById('recipeHeader').classList.replace('bg-[#D4AF37]', 'bg-[#8D6E63]');

                document.getElementById('inventoryLabel').innerText = "Beef Jus";
                document.getElementById('inventoryLabel').className = "font-bold text-[#8D6E63]";
                document.getElementById('processLabel').innerText = "Beef Jus";
                document.getElementById('processLabel').className = "font-bold text-[#8D6E63]";

                // Color updates
                updateColors('#8D6E63');
            }

            // Trigger updates
            updateInventoryData();
            if(currentTab === 'inventory') { renderInventoryTable(currentFilter); renderInventoryCharts(); }
            if(currentTab === 'process') renderTimeline();
            calculateRecipe();
            if(charts.radar) updateRadarChart();
            if(charts.cost) renderInventoryCharts();
        }

        function updateColors(color) {
            // Helper to update accent colors in UI
            document.querySelectorAll('[id^="kpi-"]').forEach(el => el.classList.replace(activeMode === 'gold' ? 'text-[#8D6E63]' : 'text-[#D4AF37]', activeMode === 'gold' ? 'text-[#D4AF37]' : 'text-[#8D6E63]'));
            const modalBtn = document.getElementById('modalSaveBtn');
            if(modalBtn) {
                modalBtn.style.backgroundColor = color;
            }
            const toastIcon = document.getElementById('toastIcon');
            if(toastIcon) toastIcon.style.color = color;
        }

        function updateInventoryData() {
            if(activeMode === 'gold') {
                inventoryData = [...baseInventory, ...goldIngredients];
            } else {
                inventoryData = [...baseInventory, ...jusIngredients];
            }
        }

        function calculateRecipe() {
            const inputVal = parseFloat(document.getElementById('recipeTarget').value) || 0;
            const list = document.getElementById('recipeList');
            list.innerHTML = '';
            
            const recipe = activeMode === 'gold' ? tareGold : tareJus;
            const colorClass = activeMode === 'gold' ? 'text-[#D4AF37]' : 'text-[#8D6E63]';
            
            if (activeMode === 'jus') {
                 // Scale factor based on 500ml base broth
                 const factor = inputVal / 500; 
                 const jusRecipeCalculated = [
                     { name: "Gyukotsu Broth", qty: inputVal, unit: "ml" },
                     { name: "Sake (Reduction)", qty: 100 * factor, unit: "ml" },
                     { name: "Mirin (Reduction)", qty: 100 * factor, unit: "ml" },
                     { name: "Koikuchi Shoyu", qty: 300 * factor, unit: "ml" },
                     { name: "Usukuchi Shoyu", qty: 100 * factor, unit: "ml" },
                     { name: "Smoked Shoyu", qty: 50 * factor, unit: "ml" }
                 ];

                 jusRecipeCalculated.forEach(item => {
                    const li = document.createElement('li');
                    li.className = "flex justify-between items-center pb-1 border-b border-[#333333] last:border-0";
                    li.innerHTML = `<span class="text-[#E0E0E0]">${item.name}</span> <span class="font-mono font-bold ${colorClass}">${Math.round(item.qty)} ${item.unit}</span>`;
                    list.appendChild(li);
                 });
                 const chartData = jusRecipeCalculated.map(i => i.qty);
                 renderRecipeChart(jusRecipeCalculated, chartData);

            } else {
                recipe.forEach(item => {
                    const qty = (item.pct * inputVal).toFixed(1);
                    const li = document.createElement('li');
                    li.className = "flex justify-between items-center pb-1 border-b border-[#333333] last:border-0";
                    li.innerHTML = `<span class="text-[#E0E0E0]">${item.name}</span> <span class="font-mono font-bold ${colorClass}">${qty} ${item.unit}</span>`;
                    list.appendChild(li);
                });
                renderRecipeChart(recipe, recipe.map(i => i.pct));
            }
        }

        // --- EDIT LOGIC ---
        function openEditModal(id) {
            const item = inventoryData.find(i => i.id === id);
            if (!item) return;
            document.getElementById('editItemId').value = item.id;
            document.getElementById('editItemName').value = item.item;
            document.getElementById('editItemBrand').value = item.brand;
            document.getElementById('editItemQty').value = item.qty;
            document.getElementById('editItemUnit').value = item.unit;
            document.getElementById('editItemCost').value = item.cost;
            const modal = document.getElementById('editModal');
            modal.classList.remove('opacity-0', 'pointer-events-none');
            document.body.classList.add('modal-active');
            modal.querySelector('.modal-container').classList.add('scale-100');
            modal.querySelector('.modal-container').classList.remove('scale-95');
        }

        function closeEditModal() {
            const modal = document.getElementById('editModal');
            modal.querySelector('.modal-container').classList.remove('scale-100');
            modal.querySelector('.modal-container').classList.add('scale-95');
            setTimeout(() => { modal.classList.add('opacity-0', 'pointer-events-none'); document.body.classList.remove('modal-active'); }, 100);
        }

        function saveEdit() {
            const id = parseInt(document.getElementById('editItemId').value);
            const itemIndex = inventoryData.findIndex(i => i.id === id);
            if (itemIndex > -1) {
                inventoryData[itemIndex].item = document.getElementById('editItemName').value;
                inventoryData[itemIndex].brand = document.getElementById('editItemBrand').value;
                inventoryData[itemIndex].qty = parseFloat(document.getElementById('editItemQty').value);
                inventoryData[itemIndex].cost = parseFloat(document.getElementById('editItemCost').value);
                if(currentTab === 'inventory') { renderInventoryTable(currentFilter); renderInventoryCharts(); }
                updateDashboardCost();
                closeEditModal();
                const toast = document.getElementById('toast');
                toast.classList.remove('translate-y-20');
                setTimeout(() => toast.classList.add('translate-y-20'), 3000);
            }
        }

        function updateDashboardCost() {
            const totalCost = inventoryData.reduce((sum, item) => sum + item.cost, 0);
            document.getElementById('costPerBowl').innerText = (totalCost / 20).toFixed(2);
        }

        // --- RENDER ---
        function renderDashboardCharts() {
            const ctx = document.getElementById('flavorRadar').getContext('2d');
            charts.radar = new Chart(ctx, {
                type: 'radar',
                data: {
                    labels: ['Sweetness (Oleic)', 'Creaminess (Gelatin)', 'Umami', 'Salt', 'Smoke', 'Aroma'],
                    datasets: [{ 
                        label: 'Profile', 
                        data: [10, 10, 8, 7, 5, 9], 
                        fill: true, 
                        backgroundColor: 'rgba(212, 175, 55, 0.2)', 
                        borderColor: '#D4AF37', 
                        pointBackgroundColor: '#D4AF37' 
                    }]
                },
                options: { responsive: true, maintainAspectRatio: false, scales: { r: { angleLines: { color: '#333333' }, grid: { color: '#333333' }, pointLabels: { color: '#A0A0A0' }, ticks: { display: false }, suggestedMin: 0, suggestedMax: 10 } }, plugins: { legend: { display: false } } }
            });
            updateRadarChart();
        }

        function updateRadarChart() {
            const data = activeMode === 'gold' ? [10, 10, 8, 7, 2, 8] : [8, 10, 10, 6, 9, 10];
            const color = activeMode === 'gold' ? '#D4AF37' : '#8D6E63';
            const bg = activeMode === 'gold' ? 'rgba(212, 175, 55, 0.2)' : 'rgba(141, 110, 99, 0.2)';
            
            if(charts.radar) {
                charts.radar.data.datasets[0].data = data;
                charts.radar.data.datasets[0].borderColor = color;
                charts.radar.data.datasets[0].backgroundColor = bg;
                charts.radar.data.datasets[0].pointBackgroundColor = color;
                charts.radar.update();
            }
        }

        function renderRecipeChart(recipeItems, dataValues) {
            if (charts.recipe) charts.recipe.destroy();
            const ctx = document.getElementById('recipeChart').getContext('2d');
            const colors = activeMode === 'gold' 
                ? ['#D4AF37', '#E0C060', '#F2E8CF', '#A0A0A0', '#555555']
                : ['#8D6E63', '#A1887F', '#BCAAA4', '#D7CCC8', '#EFEBE9', '#3E2723'];

            charts.recipe = new Chart(ctx, {
                type: 'doughnut',
                data: {
                    labels: recipeItems.map(i => i.name),
                    datasets: [{ data: dataValues, backgroundColor: colors, borderWidth: 0 }]
                },
                options: { responsive: true, maintainAspectRatio: false, plugins: { legend: { position: 'right', labels: { boxWidth: 10, font: {size: 10, family: 'Inter'}, color: '#A0A0A0' } } } }
            });
        }

        function renderInventoryTable(filter = 'all') {
            currentFilter = filter;
            const tbody = document.getElementById('inventoryTableBody');
            tbody.innerHTML = '';
            const filteredData = filter === 'all' ? inventoryData : inventoryData.filter(item => item.category === filter);
            filteredData.forEach(item => {
                const tr = document.createElement('tr');
                tr.className = "hover:bg-gray-50 transition-colors group";
                let strictBadge = item.brand.includes("Strict") || item.item.includes("Fresh") ? `<span class="inline-block bg-[#C53030] text-white text-[10px] font-bold px-1 rounded ml-2">STRICT</span>` : "";
                const highlightColor = activeMode === 'gold' ? 'hover:text-[#D4AF37]' : 'hover:text-[#8D6E63]';
                
                tr.innerHTML = `<td class="px-6 py-4 font-medium text-[#E0E0E0]">${item.item}</td><td class="px-6 py-4 text-[#A0A0A0] text-xs uppercase tracking-wide">${item.brand}${strictBadge}</td><td class="px-6 py-4 text-right font-mono text-[#E0E0E0]">${item.qty} ${item.unit}</td><td class="px-6 py-4 text-right font-mono font-bold text-[#E0E0E0]">$${item.cost.toFixed(2)}</td><td class="px-6 py-4 text-center"><button onclick="openEditModal(${item.id})" class="text-[#A0A0A0] ${highlightColor} transition-colors p-1">‚úèÔ∏è</button></td>`;
                tbody.appendChild(tr);
            });
        }

        function renderInventoryCharts() {
            if (charts.cost) charts.cost.destroy();
            const categories = {};
            inventoryData.forEach(item => { if(!categories[item.category]) categories[item.category] = 0; categories[item.category] += item.cost; });
            const ctxCost = document.getElementById('costChart').getContext('2d');
            charts.cost = new Chart(ctxCost, {
                type: 'bar',
                data: { labels: Object.keys(categories), datasets: [{ label: 'Cost ($)', data: Object.values(categories), backgroundColor: activeMode === 'gold' ? '#D4AF37' : '#8D6E63', borderRadius: 4 }] },
                options: { responsive: true, maintainAspectRatio: false, scales: { y: { beginAtZero: true, grid: { color: '#333333' }, ticks: { color: '#A0A0A0' } }, x: { grid: { display: false }, ticks: { color: '#A0A0A0' } } }, plugins: { legend: { display: false } } }
            });
        }

        function renderTimeline() {
            const nav = document.getElementById('timelineNav');
            nav.innerHTML = '';
            
            let steps = [...commonSteps];
            if(activeMode === 'jus') {
                steps.splice(3, 0, { 
                    id: 'jus1', title: "Tare Reduction (Critical)", duration: "45 Mins", icon: "üç∑", 
                    desc: "Special Step for Beef Jus: Reduce Broth Base.", 
                    checklist: ["Take 500ml broth from pot.", "Add Mirin/Sake.", "Boil down to 350ml."], 
                    tip: "This creates the demi-glace texture.", warning: null
                });
            }

            steps.forEach((step, index) => {
                const div = document.createElement('div');
                div.className = `timeline-item relative pl-12 py-4 cursor-pointer hover:bg-[#2C2C2C] rounded-r-lg transition-all group`;
                div.onclick = () => showStepDetail(index, steps);
                
                const hoverColor = activeMode === 'gold' ? 'group-hover:text-[#D4AF37]' : 'group-hover:text-[#8D6E63]';
                
                div.innerHTML = `<div class="timeline-line"></div><div class="absolute left-4 top-5 w-8 h-8 rounded-full border-2 border-[#333333] bg-[#1E1E1E] flex items-center justify-center text-sm z-10 font-bold text-[#A0A0A0]">${index + 1}</div><h4 class="font-bold text-[#E0E0E0] transition-colors ${hoverColor}">${step.title}</h4><p class="text-xs text-[#A0A0A0]">${step.duration}</p>`;
                nav.appendChild(div);
            });
            showStepDetail(0, steps);
        }

        function showStepDetail(index, steps) {
            const step = steps[index];
            document.querySelectorAll('.timeline-item').forEach((el, i) => {
                const badge = el.querySelector('.rounded-full');
                const activeColor = activeMode === 'gold' ? 'bg-[#D4AF37]' : 'bg-[#8D6E63]';
                
                if(i === index) { 
                    el.classList.add('step-active'); 
                    badge.classList.add(activeColor, 'text-[#121212]', 'border-transparent');
                    badge.classList.remove('bg-[#1E1E1E]', 'text-[#A0A0A0]');
                } else { 
                    el.classList.remove('step-active'); 
                    badge.classList.remove(activeColor, 'text-[#121212]', 'border-transparent');
                    badge.classList.add('bg-[#1E1E1E]', 'text-[#A0A0A0]');
                }
            });

            document.getElementById('detailIcon').textContent = step.icon;
            document.getElementById('detailTitle').textContent = step.title;
            document.getElementById('detailDuration').textContent = step.duration;
            document.getElementById('detailDesc').textContent = step.desc;
            document.getElementById('detailChecklistContainer').classList.remove('hidden');
            
            const tipContainer = document.getElementById('tipContainer');
            if(step.warning) {
                tipContainer.classList.remove('bg-[#252525]', 'border-[#333333]');
                tipContainer.classList.add('bg-[#3E2723]', 'border-[#C53030]');
                tipContainer.querySelector('h4').innerText = "‚ö†Ô∏è WARNING";
                tipContainer.querySelector('h4').className = "font-bold text-[#EF5350] text-sm mb-1";
                document.getElementById('detailTip').innerText = step.warning;
            } else {
                tipContainer.classList.add('bg-[#252525]', 'border-[#333333]');
                tipContainer.classList.remove('bg-[#3E2723]', 'border-[#C53030]');
                tipContainer.querySelector('h4').innerText = "üí° Pro Tip";
                tipContainer.querySelector('h4').className = `font-bold ${activeMode === 'gold' ? 'text-[#D4AF37]' : 'text-[#8D6E63]'} text-sm mb-1`;
                document.getElementById('detailTip').innerText = step.tip;
            }

            const ul = document.getElementById('detailChecklist');
            ul.innerHTML = '';
            step.checklist.forEach(item => {
                const li = document.createElement('li');
                li.className = "flex items-start gap-2 text-sm text-[#E0E0E0]";
                li.innerHTML = `<span class="${activeMode === 'gold' ? 'text-[#D4AF37]' : 'text-[#8D6E63]'}">‚úì</span> ${item}`;
                ul.appendChild(li);
            });
        }

        window.onload = function() {
            renderDashboardCharts();
            updateInventoryData();
            renderInventoryTable();
            updateDashboardCost();
            calculateRecipe();
        };
    </script>
</body>
</html>